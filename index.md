# 日本版OHR的なもの企画書

---

* 書いた人
  * Takayuki Tominaga
  * [@touka_tt](https://twitter.com/touka_tt)
* 執筆日
  * 2019.05.01
* 更新日
  * 2019.05.04

---

## 所信等
* 昨今のコロナの影響でクラブイベントがすっかりご無沙汰になっており、緊急の自粛要請が仮に5月に解けたとして、すぐにはイベント再開とはならないと見込まれる
* 別件の配信イベントのインフラ構築をやってみたところ、お金は少しかかるが、できないことはないことがわかってきたため、せっかくなので技術展開も兼ねてやっておきたい
  * ハードコア・ブレイクコアのアーティストにエンジニアが多いことは周知の通りであり、技術的難点は多いものの、みんなITリテラシー高いので実施のハードルは実は低いかもしれない
* 海外にはOHR([https://www.facebook.com/ohr.party/](https://www.facebook.com/ohr.party/))のようなオンラインパーティがあるが、日本に似たようなパーティがない
* 場所に縛られない特性上、海外のアーティストに出演して貰うことも可能であり、ある意味で普段のクラブでできないことが実現可能
* 夏頃にMプロさんがTDOHに代わるオンラインパーティを企画しており、その技術検証的にもやる意義はありそう
* マネタイズは難しいだろうけど、単純に技術的に面白そう

## 開催予定日
* 5月〜6月のどこかの週末
* 時間は出演者との要調整

## 構成
### 構成図
![kousei.png](https://touka1037.github.io/jpohr/kousei.png)
* 所謂”Music Unity”方式を応用したもの
  * DJの音声をRTMPサーバを中継する形でVJに連携
  * VJで音にあった映像を付け映像中継用RTMPサーバに連携
  * 配信サーバでOBSの入力を切り替えながら配信
* 配信先はいったんTwitchを想定
  * 音楽についてはJASRACと包括契約を結んでいるため、それが原因で止まる心配が無い
  * AzureのDCから出て行くトラフィックに対して従量課金が発生するので、複数サイトでのミラー配信はしない
    * チャット欄も一箇所の方が盛り上がりそうなので、そういう意味でも一箇所でやったほうが良さそう。
* 超ザックリとしたAzureのインフラのコスト試算は**1時間当たり約300円**です。
  * 構築費用とか、保守とかのコストを含んでない
  * すでに別件のイベントで私が構築済みなのでいったん無視します
* zukutya君に相談したところ、「AWSにMediaLiveっていう動画処理に特化したマネージドサービスあるよ」とのこと。
  * コスト面も含めて要検討
  * AzureにもMediaServiceっていうマネージドサービスあり（使ったことないけど

### 中継サーバRTMPサーバ
[SRS](https://github.com/ossrs/srs)を使っています。
低遅延モードで動かすDockerImageを作って公開しました。    
[https://hub.docker.com/r/touka1037/srs](https://hub.docker.com/r/touka1037/srs)  

```bash
docker run -p 1935:1935 -p 1985:1985 -p 8080:8080 touka1037/srs:latest
```

### インフラ試算内訳
|  | 配信サーバ |  RTMPサーバ  | 帯域 | 合計 |
| --- | --- | --- | --- | --- |
| **単価** | ¥137.088/h<br>東日本リージョン<br>NV6Promo<br>Windows10 | ¥3.0464/h<br>東日本リージョン<br>B1ms<br>CentOS7.7 | ¥13.44/GB | -- |
| **数量** | 1台 | 4台 | 10.8GB/h<br>(OBS出力および配信サーバのRDPの帯域幅を6000kbpsとする前提) | -- |
| **小計** | ¥137.088/h | ¥12.1856/h | ¥145.152/h | **¥294.4256/h** |

NV6のPromoインスタンスがまだ提供されてるのでここまで安いけど、じきにPromoの提供がなくなる。  
NV6インスタンスの通常価格は¥199.136/hなので、**¥356.4736/hが通常価格**


## メンバ
### VJ
* VJには私[@touka_tt](https://twitter.com/touka_tt)と、AWSのエンジニアやってるzukutya君[@zukutya](https://twitter.com/zukutya)をアサインしたい気持ち
  * とりあえず彼と会話してみる
  * 実現したらTokyo GabberdiscoのVJコンビになるかな

### DJ
* すくなくとも初回はITリテラシー高めの人で固めたい
* 場所の制約をうけないので、海外のアーティストにも協力いただきたい

### マネタイズ
* 配信イベントのマネタイズ難しすぎる
* 投げ銭
  * オンライン配信イベントはこっちが主流な気がする
    * PayPal donation
      * 正直使ったことないので、知見ある方いたら聞きたい・・・
    * Twitch Subscription
      * JEAさんに教えて貰った。某所で申請すれば通りそう。
* チケット
  * 配信イベントは現地の
